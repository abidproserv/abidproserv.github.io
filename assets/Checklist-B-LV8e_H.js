import{d as q,r as n,j as e,R as y,C as f,I as x}from"./index-C_0FWtUm.js";import{P as G}from"./PageTitle-BUKOvkpi.js";import{g as I,p as L,a as P}from"./httpClient-Ce5Kv-AL.js";import{C as $,a as F}from"./Card-BRu89jqC.js";import{B as o}from"./Button-DmnTiVRh.js";import{M as l}from"./Modal-BCfQSCEq.js";import{S as M}from"./Spinner-CV1K1H57.js";import{F as a}from"./Form-BBwBwUfV.js";import{T as V}from"./Table-bWG_6GMI.js";import"./divWithClassName-Bq-9A6fd.js";import"./Button-DZkCRLmd.js";import"./useWindow-BntBCDwD.js";import"./AbstractModalHeader-Dsm-yrMY.js";import"./usePrevious-ZFXiGGUU.js";import"./hasClass-C12hcuqx.js";import"./NoopTransition-bwbrAZGq.js";import"./DataKey-COGXBUcQ.js";import"./FormCheck-DdWi6gsw.js";import"./Feedback-B6Plq8hc.js";import"./FormContext-DA-Yso4Y.js";import"./ElementChildren-BCVsKVMJ.js";import"./FormControl-BErKTD8b.js";import"./FormGroup-H1BSCCGq.js";import"./FormLabel-BAMqk-uZ.js";import"./FormSelect--K4xdpmf.js";import"./FormText-BNzwvInA.js";const Ce=()=>{var N,S;const{showNotification:j}=q(),[k,R]=n.useState([]),[B,p]=n.useState(!1),[u,v]=n.useState({title:""}),[i,r]=n.useState({show:!1,checklist:null,loading:!1}),[b,h]=n.useState([]),[m,w]=n.useState(!1);n.useEffect(()=>{g()},[]);const g=async()=>{const s=await I("/api/checklist");R(s)},E=async s=>{r({show:!0,checklist:s,loading:!0});try{h(s.list||[]),r({show:!0,checklist:s,loading:!1})}catch{r({show:!1,checklist:null,loading:!1}),j({message:"Failed to fetch Checklist values",variant:"danger"})}},T=(s,t,c)=>{h(d=>d.map((C,_)=>_===s?{...C,[t]:c}:C))},z=(s,t)=>{h(c=>c.map((d,C)=>C===s?{...d,mandatory:t}:d))},A=()=>{h(s=>[...s,{text:"",mandatory:!1}])},D=s=>{h(t=>t.filter((c,d)=>d!==s))},H=s=>{const{name:t,value:c}=s.target;v({...u,[t]:c})};return e.jsxs(e.Fragment,{children:[e.jsx(G,{title:"Checklist"}),e.jsx(y,{children:e.jsx(f,{children:e.jsxs($,{children:[e.jsx(F,{children:e.jsxs("div",{className:"d-flex flex-wrap justify-content-between gap-3",children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("span",{children:e.jsx(x,{icon:"bx:search-alt"})}),e.jsx("input",{type:"search",className:"form-control",id:"search",placeholder:"Search checklist..."})]}),e.jsx("div",{children:e.jsxs(o,{variant:"primary",className:"d-inline-flex align-items-center",onClick:()=>p(!0),children:[e.jsx(x,{icon:"bx:plus",className:"me-1"}),"Create Checklist"]})})]})}),e.jsx("div",{style:{margin:"10px"},children:e.jsx(y,{children:k==null?void 0:k.map(s=>e.jsx(f,{xl:3,md:3,children:e.jsx("div",{className:`card bg-${s.status==="inactive"?"secondary":"success"} text-white`,style:{cursor:"pointer"},onClick:()=>E(s),children:e.jsxs(F,{className:"d-flex align-items-center justify-content-between",children:[e.jsx("h5",{className:"card-title text-white mb-1",children:s==null?void 0:s.name}),e.jsx(x,{icon:"carbon:view-filled",style:{fontSize:24}})]})})},s._id))})})]})})}),e.jsxs(l,{show:i.show,onHide:()=>r({...i,show:!1}),size:"lg",children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:"Edit Checklist Values"})}),e.jsx(l.Body,{children:i.loading?e.jsx("div",{className:"text-center py-5",children:e.jsx(M,{animation:"border"})}):e.jsxs(e.Fragment,{children:[e.jsxs(y,{className:"mb-3",children:[e.jsx(f,{md:6,children:e.jsxs(a.Group,{children:[e.jsx(a.Label,{children:"Checklist Name"}),e.jsx(a.Control,{value:((N=i.checklist)==null?void 0:N.name)||"",onChange:s=>r(t=>({...t,checklist:{...t.checklist,name:s.target.value}})),required:!0})]})}),e.jsx(f,{md:6,className:"d-flex align-items-end",style:{paddingTop:0,paddingBottom:0},children:e.jsx(a.Group,{className:"mb-0 ms-3",children:e.jsx(a.Check,{type:"checkbox",label:"Active",checked:((S=i.checklist)==null?void 0:S.status)==="active",onChange:s=>r(t=>({...t,checklist:{...t.checklist,status:s.target.checked?"active":"inactive"}}))})})})]}),e.jsxs(V,{bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Text"}),e.jsx("th",{children:"Mandatory"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:b.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(a.Control,{value:s.text,onChange:c=>T(t,"text",c.target.value),required:!0})}),e.jsx("td",{className:"text-center",children:e.jsx(a.Check,{type:"checkbox",checked:!!s.mandatory,onChange:c=>z(t,c.target.checked)})}),e.jsx("td",{children:e.jsx(o,{variant:"danger",size:"sm",onClick:()=>D(t),disabled:m,children:e.jsx(x,{icon:"mdi:delete"})})})]},s._id||t))})]}),e.jsxs(o,{variant:"outline-primary",onClick:A,className:"mb-3",disabled:m,children:[e.jsx(x,{icon:"mdi:plus",className:"me-1"}),"Add Row"]})]})}),e.jsxs(l.Footer,{children:[e.jsx(o,{variant:"secondary",onClick:()=>r({...i,show:!1}),disabled:m,children:"Cancel"}),e.jsxs(o,{variant:"primary",onClick:async()=>{w(!0);try{await L(`/api/checklist/${i.checklist._id}`,{name:i.checklist.name,status:i.checklist.status,list:b}),r({...i,show:!1}),j({message:"Checklist updated successfully",variant:"success"}),g()}catch{j({message:"Failed to update Checklist",variant:"danger"})}w(!1)},disabled:m,children:[m&&e.jsx(M,{animation:"border",size:"sm",className:"me-2"}),"Save"]})]})]}),e.jsxs(l,{show:B,onHide:()=>p(!1),children:[e.jsx(l.Header,{closeButton:!0,children:e.jsx(l.Title,{children:"Create Checklist"})}),e.jsxs(a,{onSubmit:async s=>{s.preventDefault(),await P("/api/checklist/add-type",{name:u.title}),p(!1),v({...u,title:""}),g(),j({message:"Checklist added successfully",variant:"success"})},children:[e.jsx(l.Body,{children:e.jsxs(a.Group,{className:"mb-3",children:[e.jsx(a.Label,{children:"Checklist Name"}),e.jsx(a.Control,{name:"title",value:u.title,onChange:H,required:!0})]})}),e.jsxs(l.Footer,{children:[e.jsx(o,{variant:"secondary",onClick:()=>p(!1),children:"Cancel"}),e.jsx(o,{variant:"primary",type:"submit",children:"Create"})]})]})]})]})};export{Ce as default};
