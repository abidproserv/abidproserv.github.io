import{d as z,r as l,j as e,R as N,C as S,I as h}from"./index-C_0FWtUm.js";import{P as H}from"./PageTitle-BUKOvkpi.js";import{g as L,a as V,p as A}from"./httpClient-Ce5Kv-AL.js";import{C as I,a as O}from"./Card-BRu89jqC.js";import{B as n}from"./Button-DmnTiVRh.js";import{M as t}from"./Modal-BCfQSCEq.js";import{S as F}from"./Spinner-CV1K1H57.js";import{T as P}from"./Table-bWG_6GMI.js";import{F as c}from"./Form-BBwBwUfV.js";import"./divWithClassName-Bq-9A6fd.js";import"./Button-DZkCRLmd.js";import"./useWindow-BntBCDwD.js";import"./AbstractModalHeader-Dsm-yrMY.js";import"./usePrevious-ZFXiGGUU.js";import"./hasClass-C12hcuqx.js";import"./NoopTransition-bwbrAZGq.js";import"./DataKey-COGXBUcQ.js";import"./FormCheck-DdWi6gsw.js";import"./Feedback-B6Plq8hc.js";import"./FormContext-DA-Yso4Y.js";import"./ElementChildren-BCVsKVMJ.js";import"./FormControl-BErKTD8b.js";import"./FormGroup-H1BSCCGq.js";import"./FormLabel-BAMqk-uZ.js";import"./FormSelect--K4xdpmf.js";import"./FormText-BNzwvInA.js";const ue=()=>{const{showNotification:m}=z(),[j,R]=l.useState([]),[k,x]=l.useState(!1),[p,g]=l.useState({title:""}),[i,o]=l.useState({show:!1,type:"",rows:[],loading:!1}),[w,u]=l.useState([]),[d,y]=l.useState(!1);l.useEffect(()=>{f()},[]);const f=async()=>{const s=await L("/api/lov/LOV_TYPE");R(s)},B=async s=>{o({show:!0,type:s,rows:[],loading:!0});try{const a=await L(`/api/lov/${s}`);u(a),o({show:!0,type:s,rows:a,loading:!1})}catch{o({show:!1,type:"",rows:[],loading:!1}),m({message:"Failed to fetch LOV values",variant:"danger"})}},C=(s,a,r)=>{u(v=>v.map((b,T)=>T===s?{...b,[a]:r}:b))},M=()=>{u(s=>[...s,{_id:void 0,type:i.type,value:"",attribute1:""}])},_=s=>{u(a=>a.filter((r,v)=>v!==s))},E=async()=>{y(!0);try{for(const s of w)s._id?await A(`/api/lov/${s._id}`,s):await V("/api/lov",s);o({...i,show:!1}),m({message:"LOV updated successfully",variant:"success"}),f()}catch{m({message:"Failed to update LOV",variant:"danger"})}y(!1)},D=s=>{const{name:a,value:r}=s.target;g({...p,[a]:r})};return e.jsxs(e.Fragment,{children:[e.jsx(H,{title:"LOV"}),e.jsx(N,{children:e.jsx(S,{children:e.jsxs(I,{children:[e.jsx(O,{children:e.jsxs("div",{className:"d-flex flex-wrap justify-content-between gap-3",children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("span",{children:e.jsx(h,{icon:"bx:search-alt"})}),e.jsx("input",{type:"search",className:"form-control",id:"search",placeholder:"Search lov..."})]}),e.jsx("div",{children:e.jsxs(n,{variant:"primary",className:"d-inline-flex align-items-center",onClick:()=>x(!0),children:[e.jsx(h,{icon:"bx:plus",className:"me-1"}),"Create List of Values"]})})]})}),e.jsx("div",{style:{margin:"10px"},children:e.jsx(N,{children:j==null?void 0:j.map(s=>e.jsx(S,{xl:3,md:3,children:e.jsx("div",{className:"card bg-secondary text-white",style:{cursor:"pointer"},onClick:()=>B(s==null?void 0:s.value),children:e.jsxs(O,{className:"d-flex align-items-center justify-content-between",children:[e.jsx("h5",{className:"card-title text-white mb-1",children:s==null?void 0:s.value}),e.jsx(h,{icon:"carbon:view-filled",style:{fontSize:24}})]})})},s._id))})})]})})}),e.jsxs(t,{show:i.show,onHide:()=>o({...i,show:!1}),size:"lg",children:[e.jsx(t.Header,{closeButton:!0,children:e.jsxs(t.Title,{children:["Edit ",i.type," Values"]})}),e.jsx(t.Body,{children:i.loading?e.jsx("div",{className:"text-center py-5",children:e.jsx(F,{animation:"border"})}):e.jsxs(e.Fragment,{children:[e.jsxs(P,{bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Value"}),e.jsx("th",{children:"Depends On"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:w.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(c.Control,{value:s.value,onChange:r=>C(a,"value",r.target.value),required:!0})}),e.jsx("td",{children:e.jsx(c.Control,{value:s.attribute1||"",onChange:r=>C(a,"attribute1",r.target.value)})}),e.jsx("td",{children:e.jsx(n,{variant:"danger",size:"sm",onClick:()=>_(a),disabled:d,children:e.jsx(h,{icon:"mdi:delete"})})})]},s._id||a))})]}),e.jsxs(n,{variant:"outline-primary",onClick:M,className:"mb-3",disabled:d,children:[e.jsx(h,{icon:"mdi:plus",className:"me-1"}),"Add Row"]})]})}),e.jsxs(t.Footer,{children:[e.jsx(n,{variant:"secondary",onClick:()=>o({...i,show:!1}),disabled:d,children:"Cancel"}),e.jsxs(n,{variant:"primary",onClick:E,disabled:d,children:[d&&e.jsx(F,{animation:"border",size:"sm",className:"me-2"}),"Save"]})]})]}),e.jsxs(t,{show:k,onHide:()=>x(!1),children:[e.jsx(t.Header,{closeButton:!0,children:e.jsx(t.Title,{children:"Create LOV"})}),e.jsxs(c,{onSubmit:async s=>{s.preventDefault(),await V("/api/lov/add-lov-type",{name:p.title}),x(!1),g({...p,title:""}),f(),m({message:"LOV added successfully",variant:"success"})},children:[e.jsx(t.Body,{children:e.jsxs(c.Group,{className:"mb-3",children:[e.jsx(c.Label,{children:"LOV Name"}),e.jsx(c.Control,{name:"title",value:p.title,onChange:D,required:!0})]})}),e.jsxs(t.Footer,{children:[e.jsx(n,{variant:"secondary",onClick:()=>x(!1),children:"Cancel"}),e.jsx(n,{variant:"primary",type:"submit",children:"Create"})]})]})]})]})};export{ue as default};
